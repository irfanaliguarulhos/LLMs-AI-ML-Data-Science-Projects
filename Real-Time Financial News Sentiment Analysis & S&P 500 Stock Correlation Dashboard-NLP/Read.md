# ğŸ“ˆ Market Pulse AI: Real-Time Financial News Sentiment & SPY Forecast Dashboard ğŸ“‰

[![Python Version](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Framework: Dash](https://img.shields.io/badge/Framework-Dash-blue.svg)](https://plotly.com/dash/)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

Welcome to the Market Pulse AI Dashboard! This project leverages Natural Language Processing (NLP) and Deep Learning (LSTM) to provide real-time insights into the S&P 500 (SPY ETF) by analyzing financial news sentiment and predicting future price movements.

ğŸ“Š **Explore the Live Demo (if deployed) or Run Locally!** ğŸš€

---

## âœ¨ Overview

This interactive dashboard aims to bridge the gap between breaking financial news and stock market reactions. It performs the following key tasks:

1.  **Data Aggregation:** Fetches near real-time financial news headlines (via NewsAPI) and historical S&P 500 (SPY) price data (via yfinance).
2.  **Sentiment Analysis:** Utilizes a pre-trained **FinBERT** model (fine-tuned for financial text) to classify the sentiment (Positive, Negative, Neutral) of news headlines.
3.  **Correlation Analysis:** Calculates the rolling correlation between the aggregated daily news sentiment score and the SPY's daily price changes.
4.  **Price Prediction:** Employs a Long Short-Term Memory (**LSTM**) neural network, a type of Recurrent Neural Network (RNN), to forecast future SPY closing prices based on historical price patterns.
5.  **AI Summary:** Uses a **DistilGPT-2** language model to generate a concise textual summary of the current market situation based on the latest data, sentiment, correlation, and LSTM predictions.
6.  **Interactive Dashboard:** Presents all insights through a user-friendly web interface built with **Plotly Dash**, allowing users to select date ranges, trigger model retraining, update sentiment data, and generate AI summaries on demand.

## ğŸ“¸ Dashboard Screenshots

*(Replace with your actual screenshot paths/names)*

![Dashboard Screenshot 1](assets/dashboard_screenshot_1.png)
*Main dashboard view showing price predictions and sentiment trends.*

![Dashboard Screenshot 2](assets/dashboard_screenshot_2.png)
*AI Summary and metrics display.*

## ğŸš€ Key Features

*   ğŸ“° **Real-time News Fetching:** Gathers latest financial news relevant to the S&P 500.
*   ğŸ¤– **FinBERT Sentiment Analysis:** Accurate sentiment scoring specifically for financial contexts.
*   ğŸ“ˆ **LSTM Price Prediction:** Deep learning model to forecast future price movements.
*   ğŸ”— **Sentiment-Price Correlation:** Visualizes the rolling relationship between news sentiment and stock price changes.
*   ğŸ’¡ **AI-Generated Summaries:** Concise market outlook generated by a language model based on analyzed data.
*   ğŸ“… **Interactive Date Range Selection:** Analyze specific historical periods.
*   ğŸ”„ **On-Demand Model Retraining:** Update the LSTM model with the latest available data.
*   âœ¨ **Dynamic Updates:** Refresh sentiment data and trigger AI summaries with button clicks.
*   ğŸ“Š **Clear Visualizations:** Powered by Plotly for interactive charts.

## ğŸ› ï¸ Technologies Used

*   **Programming Language:** Python 3.8+
*   **Data Handling:** Pandas, NumPy
*   **Web Framework:** Dash (by Plotly)
*   **Plotting:** Plotly Express, Plotly Graph Objects
*   **Data Fetching:** yfinance, NewsAPI-Python
*   **NLP (Sentiment):** Hugging Face Transformers (ProsusAI/finbert), PyTorch
*   **Deep Learning (Prediction):** TensorFlow, Keras (tf.keras API)
*   **Machine Learning Utilities:** Scikit-learn (MinMaxScaler)
*   **NLP (Summary):** Hugging Face Transformers (distilgpt2)
*   **Environment Variables:** python-dotenv

## ğŸ“‚ Project Structure
`````
â”‚
â”œâ”€â”€ assets/ # Images for README
â”‚ â”œâ”€â”€ dashboard_screenshot_1.png
â”‚ â””â”€â”€ dashboard_screenshot_2.png
â”‚
â”œâ”€â”€ market_pulse_dashboard.py # Main application script
â”œâ”€â”€ requirements.txt # Python dependencies
â”œâ”€â”€ .gitignore # Files/folders to ignore for Git
â”œâ”€â”€ .env.example # Example environment variable file
â”œâ”€â”€ README.md # This file
â”‚
â””â”€â”€ (Generated Files - Not Committed by default)
â”œâ”€â”€ .env # Your local environment variables (KEEP PRIVATE!)
â”œâ”€â”€ SPY_stock_prices.csv
â”œâ”€â”€ SPY_news_data.csv
â”œâ”€â”€ SPY_news_sentiment.csv
â””â”€â”€ SPY_merged_data.csv
``````

## âš™ï¸ Setup and Installation

Follow these steps to set up and run the project locally:

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/irfanaliguarulhos/LLMs-AI-ML-Data-Science-Projects.git
    cd "LLMs-AI-ML-Data-Science-Projects/Real-Time Financial News Sentiment Analysis & SP 500 Stock Correlation Dashboard (NLP)"
    ```

2.  **Create a Virtual Environment (Recommended):**
    ```bash
    python -m venv venv
    # On Windows
    venv\Scripts\activate
    # On macOS/Linux
    source venv/bin/activate
    ```

3.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
    *(Note: Installation might take some time, especially for PyTorch/TensorFlow).*

4.  **Set Up API Key:**
    *   Get a free API key from [newsapi.org](https://newsapi.org/).
    *   Rename the `.env.example` file to `.env`.
    *   Open the `.env` file and paste your actual NewsAPI key:
        ```text
        NEWSAPI_KEY="YOUR_ACTUAL_NEWSAPI_KEY_HERE"
        ```

5.  **Run the Dashboard:**
    ```bash
    python market_pulse_dashboard.py

6.  **Access the Dashboard:**
    Open your web browser and navigate to `http://127.0.0.1:8050` (or the address provided in the terminal). The initial data loading and model training might take a minute or two the first time.

## ğŸ–±ï¸ Usage

*   **Date Range Picker:** Select a start and end date to filter the data displayed in the graphs.
*   **Train LSTM & Predict Button:** Click to retrain the LSTM model using all available historical data up to the latest point. This updates the prediction line on the price graph and the LSTM performance metrics.
*   **Update Sentiment Data Button:** Fetches the latest news headlines, runs sentiment analysis, re-merges the data, and updates the sentiment metrics. *Note: This resets the prediction line as it's based on potentially new data.* You'll need to click "Train LSTM" again for updated predictions.
*   **Generate AI Summary Button:** Click to generate a textual summary based on the *currently available* data, sentiment metrics, and LSTM predictions (either initial or after retraining).

## ğŸ’¡ How It Works (Pipeline)

1.  **Data Fetching:** Retrieves SPY prices (`yfinance`) and news (`NewsAPI`).
2.  **Sentiment Analysis:** Processes news titles with `FinBERT` to get sentiment scores.
3.  **Preprocessing & Merging:** Aggregates daily sentiment and merges it with stock data. Calculates `price_change` and `sentiment_price_corr`. Ensures data types are correct.
4.  **LSTM Training:** Prepares time-series sequences from 'Close' prices, scales data, builds, trains, and validates the LSTM model.
5.  **Prediction:** Uses the trained LSTM to predict future 'Close' prices on the test set.
6.  **AI Summary Generation:** Feeds key metrics (latest price, sentiment, correlation, prediction trend, accuracy) into `DistilGPT-2` via a structured prompt to get a summary.
7.  **Dashboard Display:** `Dash` uses `Plotly` to visualize the data and predictions. Callbacks handle user interactions (button clicks, date changes) to trigger updates and recalculations.

## ğŸ”® Potential Improvements & Future Work

*   **More Data Sources:** Integrate other sentiment sources (Twitter, Reddit, StockTwits).
*   **Advanced Models:** Experiment with different LSTM architectures (BiLSTM, Attention), other time-series models (GRU, ARIMA, Prophet), or incorporate sentiment scores directly into the prediction model features.
*   **Real-time Streaming:** Implement data fetching and updates on a schedule or via streaming APIs for true real-time analysis (would require a more robust architecture).
*   **Deployment:** Deploy the dashboard to a cloud platform (Heroku, AWS, Google Cloud) for public access.
*   **Error Handling:** Add more granular error handling and user feedback within the dashboard.
*   **Backtesting:** Implement a backtesting framework to evaluate the prediction model's historical performance more rigorously.
*   **Caching:** Use caching mechanisms (e.g., Flask-Caching with Dash) to speed up repeated data loading or calculations.

## ğŸ“œ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file (if you add one) for details.

## ğŸ‘¤ Author

*   **Irfan Ali** - [irfanaliguarulhos](https://github.com/irfanaliguarulhos)

---

*Thank you for checking out the Market Pulse AI Dashboard!*
